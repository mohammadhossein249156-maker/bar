<script>
// اتصالات UI
document.getElementById('refreshBtn').addEventListener('click', async ()=>{
  const symbolSearch = document.getElementById('searchBox').value.trim().toUpperCase();
  const allIntervals = symbolSearch.length>0;
  setLoading(true);

  try {
    if(allIntervals){ 
      // جستجوی سمبل با همه تایم‌فریم‌ها همزمان
      const promises = INTERVALS.map(interval => buildTable(symbolSearch, true, interval));
      await Promise.all(promises);
    } else {
      await buildTable();
    }
  } finally {
    setLoading(false);
  }
});

// تغییر تایم‌فریم
document.getElementById('interval').addEventListener('change',()=>buildTable());

// load اولیه
window.addEventListener('load',()=>buildTable());
</script>
